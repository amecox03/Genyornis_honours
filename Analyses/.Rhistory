knitr::opts_chunk$set(echo=FALSE, message=FALSE, results='hide' )
#this sets the directory to the source directory without having to manually click your way there
library(rstudioapi) # Safely Access the RStudio API
setwd(dirname(getActiveDocumentContext()$path))
#make sure you delete all empty columns/rows by hitting "delete" in excel
data<-read.csv(file = "../Data/Raw/honours_hindlimbs.csv")
#data that includes Dinornithiformes, Dromornis stirtoni, & Illbandornis sp.
data2 <- read.csv (file = "../Data/Raw/honours_hindlimb_updated.csv")
library(tidyverse)
data_aepyorn <- read.csv(file = "../Data/Raw/Aepyronithid_hindlimb_measurements.csv")
#some numeric columns import as non-numeric, as.numeric changes these columns into numeric columns
data_aepyorn[, 5] <- as.numeric(data_aepyorn [,5])
data_aepyorn[,10] <- as.numeric (data_aepyorn[,10])
data_aepyorn[,12] <- as.numeric (data_aepyorn[,12])
data_aepyorn[,15] <- as.numeric (data_aepyorn[,15])
#species name for which mean is to be calculated for A. hildebrandti
aep.hil <- c("hildebrandti")
#a subset data frame for the rows that i want to target for A. hildebrandti
subset_data <- data_aepyorn[data_aepyorn$genus %in% aep.hil,]
#calculate the means of Aepyornis hildebrandti
aep.hilm <- colMeans(subset_data[, c("fL", "fPW", "fDW", "fCr.Ca","fM.L","tbL","tbPW", "tbDW","tbCr.Ca","tbM.L","tmtL","tmtD.P","tmtM.L")], na.rm = TRUE)
#printing the means for Aepyornis hildebrandti
print(aep.hilm)
#species name for which mean is to be calculated for A. maximus
aep.max <- c("maximus")
#a subset data frame for the rows that i want to target for A. maximus
subset_datam <- data_aepyorn[data_aepyorn$genus %in% aep.max,]
#calculate the means of Aepyornis maximus
aep.maxi <- colMeans(subset_datam[, c("fL", "fPW", "fDW", "fCr.Ca","fM.L","tbL","tbPW", "tbDW","tbCr.Ca","tbM.L","tmtL","tmtD.P","tmtM.L")], na.rm = TRUE)
#printing the means for Aepyornis maximus
print(aep.maxi)
#species name for which mean is to be calculated for M. modestus
mul.mod <- c("modestus")
#a subset data frame for the rows that i want to target for M. modestus
subset_datamm <- data_aepyorn[data_aepyorn$genus %in% mul.mod,]
#calculate the means of M. modestus
mul.mode <- colMeans(subset_datamm[, c("fL", "fPW", "fDW", "fCr.Ca","fM.L","tbL","tbPW", "tbDW","tbCr.Ca","tbM.L","tmtL","tmtD.P","tmtM.L")], na.rm = TRUE)
#printing the means for M. modestus
print(mul.mode)
data2_noD <- data2[-c(124:132),]
#linear model of the femur medial lateral width against tibia medial lateral width, w/o dromornithids
noD_widths <- lm(log(data2_noD$fM.L)~log(data2_noD$tbM.L))
#linear model of the femur medial lateral width against tibia medial lateral width w/ dromorntiids
wD_widths <- lm(log(data2$fM.L)~log(data2$tbM.L))
#summary of the two linear models
summary(noD_widths)
summary(wD_widths)
#Here we're log transforming first, because otherwise things don't work.
data_plot <- cbind (data2[,1:3], log (data2[,4:16]))
#Also here setting up a vector of colours you can use to highlight _Genyornis_
#make a vector of just pink
colours <- rep("hotpink", nrow(data_plot))
#make a vector where any species name that has Genyornis is assigned purple
colours[which(data_plot$species == "Genyornis newtoni")] <- "#33cc33"
colours[which(data_plot$species == "Illbandornis lawsoni")] <- "#196619"
colours[which(data_plot$species == "Illbandornis woodburnei")] <- "green"
colours[which(data_plot$species == "Aepyornis maximus")] <- "#ff0000"
colours[which(data_plot$species == "Mullerornis modestus")] <- "#cc0000"
colours[which(data_plot$species == "Dinornis robustus")] <- "#ff6600"
colours[which(data_plot$species == "Dinornis novaezealandiae")] <- "#b34700"
colours[which(data_plot$species == "Pachyornis elephantopus")] <- "#ffc299"
colours[which(data_plot$species == "Struthio camelus")] <- "#191966"
colours[which(data_plot$species == "Dromaius novaehollandiae")] <- "#3366ff"
colours[which(data_plot$species == "Casuarius casuarius")] <- "#3333cc"
colours[which(data_plot$species == "Leipoa ocellata")] <- "#9900cc"
colours[which(data_plot$species == "Alectura lathami")] <- "#800080"
colours[which(data_plot$species == "Cereopsis novaehollandiae")] <- "#ff00ff"
colours[which(data_plot$species == "Anseranas semipalmata")] <- "#ff0055"
#getting a model for predicting CIs
model1 <- lm(fM.L ~ tbM.L, data=data_plot)
summary(model1)
#For the interval estimate to work, we need to find the smallest and largest values of x. All this is in https://stackoverflow.com/questions/46459620/plotting-a-95-confidence-interval-for-a-lm-object
#But X in this case has NAs so we're here finding the lowest non-NA value by sorting from smallest to largest and taking the first value
min_x <- sort(data_plot$tbM.L)[1]
max_x <- sort(data_plot$tbM.L, decreasing = TRUE)[1]
#make dummy sequence of x for intervals.
newx <- seq(min_x-1,max_x+1,by = 0.05 )
#plot confidence intervals
#This only works if the data are already logged. Not my preference but hey.
conf_interval <- predict(model1, newdata=data.frame(tbM.L = newx), interval="prediction", level = 0.95)
plot(data_plot$fM.L ~ data_plot$tbM.L,
xlim=c(1.6,4.5),
ylim=c(1.7,4.5),
pch=19, col=colours); abline(noD_widths, col="black" )
lines(newx, conf_interval[,2], col="blue", lty=2)
lines(newx, conf_interval[,3], col="blue", lty=2)
#fill in area between regression line and confidence interval - very pretty but then you have to re-plot the points
polygon(c(rev(newx), newx), c(rev(conf_interval[ ,3]), conf_interval[ ,2]), density = 25,col = 'grey', border = NA)
points(data_plot$fM.L ~ data_plot$tbM.L,
pch=19, col=colours); abline(noD_widths, col="black" )
lines(newx, conf_interval[,2], col="blue", lty=2)
lines(newx, conf_interval[,3], col="blue", lty=2)
#add row names to your plot
#text(data_plot$fM.L ~ data_plot$tbM.L, labels=data_plot$species )
#make a data set with extant ratites
ratite <- data2[c(5:25),]
#make a data set with extinct large birds (ratites + dromorntithids)
extinct <- data2[c(77:132),]
#combine the 2 datasets
largebirds_data <- rbind(ratite, extinct)
largebirds_plot <- cbind (largebirds_data[,1:3], log (largebirds_data[,4:16]))
#Also here setting up a vector of colours you can use to highlight _Genyornis_
#make a vector of just pink
colours <- rep("hotpink", nrow(largebirds_plot))
#make a vector where any species name that has Genyornis is assigned purple
colours[which(largebirds_plot$species == "Genyornis newtoni")] <- "#33cc33"
colours[which(largebirds_plot$species == "Illbandornis lawsoni")] <- "#196619"
colours[which(largebirds_plot$species == "Illbandornis woodburnei")] <- "green"
colours[which(largebirds_plot$species == "Aepyornis maximus")] <- "#ff0000"
colours[which(largebirds_plot$species == "Mullerornis modestus")] <- "#cc0000"
colours[which(largebirds_plot$species == "Dinornis robustus")] <- "#ff6600"
colours[which(largebirds_plot$species == "Dinornis novaezealandiae")] <- "#b34700"
colours[which(largebirds_plot$species == "Pachyornis elephantopus")] <- "#ffc299"
colours[which(largebirds_plot$species == "Struthio camelus")] <- "#191966"
colours[which(largebirds_plot$species == "Dromaius novaehollandiae")] <- "#3366ff"
colours[which(largebirds_plot$species == "Casuarius casuarius")] <- "#3333cc"
#linear model of the femur width vs tibia width in large flightless birds
model3 <- lm(fM.L ~ tbM.L, data=largebirds_plot)
#summary output of the linear model
summary (model3)
min_xB <- sort(largebirds_plot$tbM.L)[1]
max_xB <- sort(largebirds_plot$tbM.L, decreasing = TRUE)[1]
#make dummy sequence of x for intervals.
newxB <- seq(min_xB-1,max_xB+1,by = 0.05)
#plot confidence intervals
#This only works if the data are already logged. Not my preference but hey.
conf_intervalB <- predict(model3, newdata=data.frame(tbM.L = newxB), interval="prediction", level = 0.95)
plot (largebirds_plot$fM.L ~ largebirds_plot$tbM.L,
pch=19, col=colours); abline(model3, col="black" )
lines(newxB, conf_intervalB[,2], col="blue", lty=2)
lines(newxB, conf_intervalB[,3], col="blue", lty=2)
#fill in area between regression line and confidence interval - very pretty but then you have to re-plot the points
polygon(c(rev(newxB), newxB), c(rev(conf_intervalB[ ,3]), conf_intervalB[ ,2]), density = 25, col = 'grey', border = NA)
points(largebirds_plot$fM.L ~ largebirds_plot$tbM.L,
pch=19, col=colours); abline(model3, col="black" )
lines(newxB, conf_intervalB[,2], col="blue", lty=2)
lines(newxB, conf_intervalB[,3], col="blue", lty=2)
#make a vector of just pink
colours <- rep("hotpink", nrow(data_plot))
#make a vector where any species name that has Genyornis is assigned purple
colours[which(data_plot$species == "Genyornis newtoni")] <- "#33cc33"
colours[which(data_plot$species == "Illbandornis lawsoni")] <- "#196619"
colours[which(data_plot$species == "Illbandornis woodburnei")] <- "green"
colours[which(data_plot$species == "Aepyornis maximus")] <- "#ff0000"
colours[which(data_plot$species == "Aepyornis hildebrandti")] <- "red"
colours[which(data_plot$species == "Mullerornis modestus")] <- "#cc0000"
colours[which(data_plot$species == "Dinornis robustus")] <- "#ff6600"
colours[which(data_plot$species == "Dinornis novaezealandiae")] <- "#b34700"
colours[which(data_plot$species == "Pachyornis elephantopus")] <- "#ffc299"
colours[which(data_plot$species == "Struthio camelus")] <- "#191966"
colours[which(data_plot$species == "Dromaius novaehollandiae")] <- "#3366ff"
colours[which(data_plot$species == "Casuarius casuarius")] <- "#3333cc"
colours[which(data_plot$species == "Leipoa ocellata")] <- "#9900cc"
colours[which(data_plot$species == "Alectura lathami")] <- "#800080"
colours[which(data_plot$species == "Cereopsis novaehollandiae")] <- "#ff00ff"
colours[which(data_plot$species == "Anseranas semipalmata")] <- "#ff0055"
#getting a model for predicting CIs
modelFLW <- lm(fL ~ fM.L, data=data_plot)
summary(modelFLW)
#For the interval estimate to work, we need to find the smallest and largest values of x. All this is in https://stackoverflow.com/questions/46459620/plotting-a-95-confidence-interval-for-a-lm-object
#But X in this case has NAs so we're here finding the lowest non-NA value by sorting from smallest to largest and taking the first value
min_xW <- sort(data_plot$fM.L)[1]
max_xW <- sort(data_plot$fM.L, decreasing = TRUE)[1]
#make dummy sequence of x for intervals.
newxW <- seq(min_xW-1,max_xW+1,by = 0.05 )
#plot confidence intervals
#This only works if the data are already logged. Not my preference but hey.
conf_intervalW <- predict(modelFLW, newdata=data.frame(fM.L = newxW), interval="prediction", level = 0.95)
plot(data_plot$fL ~ data_plot$fM.L,
pch=19, col=colours); abline(modelFLW, col="black" )
lines(newxW, conf_intervalW [,2], col="blue", lty=2)
lines(newxW, conf_intervalW [,3], col="blue", lty=2)
#fill in area between regression line and confidence interval - very pretty but then you have to re-plot the points
polygon(c(rev(newxW), newxW), c(rev(conf_intervalW [ ,3]), conf_intervalW[ ,2]),density = 25, col = 'grey', border = NA)
points(data_plot$fL ~ data_plot$fM.L,
pch=19, col=colours); abline(modelFLW, col="black" )
lines(newxW, conf_intervalW [,2], col="blue", lty=2)
lines(newxW, conf_intervalW [,3], col="blue", lty=2)
#text to data points
#text(log(data$fL) ~ log(data$fM.L), label=data$species)
#getting a model for predicting CIs
modelFLW <- lm(fM.L ~ fL, data=data_plot)
summary(modelFLW)
#But X in this case has NAs so we're here finding the lowest non-NA value by sorting from smallest to largest and taking the first value
min_xW <- sort(data_plot$fM.L)[1]
max_xW <- sort(data_plot$fM.L, decreasing = TRUE)[1]
#make dummy sequence of x for intervals.
newxW <- seq(min_xW-1,max_xW+1,by = 0.05 )
#But X in this case has NAs so we're here finding the lowest non-NA value by sorting from smallest to largest and taking the first value
min_xW <- sort(data_plot$L)[1]
max_xW <- sort(data_plot$fL, decreasing = TRUE)[1]
#This only works if the data are already logged. Not my preference but hey.
conf_intervalW <- predict(modelFLW, newdata=data.frame(fL = newxW), interval="prediction", level = 0.95)
plot(data_plot$fL ~ data_plot$fM.L,
pch=19, col=colours); abline(modelFLW, col="black" )
plot(data_plot$fM.L ~ data_plot$fL,
pch=19, col=colours); abline(modelFLW, col="black" )
lines(newxW, conf_intervalW [,2], col="blue", lty=2)
lines(newxW, conf_intervalW [,3], col="blue", lty=2)
#This only works if the data are already logged. Not my preference but hey.
conf_intervalW <- predict(modelFLW, newdata=data.frame(fM.L = newxW), interval="prediction", level = 0.95)
plot(data_plot$fM.L ~ data_plot$fL,
pch=19, col=colours); abline(modelFLW, col="black" )
#getting a model for predicting CIs
modelFLW <- lm(fM.L ~ fL, data=data_plot)
summary(modelFLW)
#But X in this case has NAs so we're here finding the lowest non-NA value by sorting from smallest to largest and taking the first value
min_xW <- sort(data_plot$fL)[1]
max_xW <- sort(data_plot$fL, decreasing = TRUE)[1]
#make dummy sequence of x for intervals.
newxW <- seq(min_xW-1,max_xW+1,by = 0.05 )
#This only works if the data are already logged. Not my preference but hey.
conf_intervalW <- predict(modelFLW, newdata=data.frame(fL = newxW), interval="prediction", level = 0.95)
plot(data_plot$fM.L ~ data_plot$fL,
pch=19, col=colours); abline(modelFLW, col="black" )
lines(newxW, conf_intervalW [,2], col="blue", lty=2)
lines(newxW, conf_intervalW [,3], col="blue", lty=2)
#fill in area between regression line and confidence interval - very pretty but then you have to re-plot the points
polygon(c(rev(newxW), newxW), c(rev(conf_intervalW [ ,3]), conf_intervalW[ ,2]),density = 25, col = 'grey', border = NA)
points(data_plot$fM.L ~ data_plot$fL,
pch=19, col=colours); abline(modelFLW, col="black" )
lines(newxW, conf_intervalW [,2], col="blue", lty=2)
lines(newxW, conf_intervalW [,3], col="blue", lty=2)
#getting a model for predicting CIs
modelFTL <- lm(fL ~ tbL, data=data_plot)
summary(modelFTL)
#For the interval estimate to work, we need to find the smallest and largest values of x. All this is in https://stackoverflow.com/questions/46459620/plotting-a-95-confidence-interval-for-a-lm-object
#But X in this case has NAs so we're here finding the lowest non-NA value by sorting from smallest to largest and taking the first value
min_xL <- sort(data_plot$tbL)[1]
max_xL <- sort(data_plot$tbL, decreasing = TRUE)[1]
#make dummy sequence of x for intervals.
newxL <- seq(min_xL-1,max_xL+1,by = 0.05 )
#plot confidence intervals
#This only works if the data are already logged. Not my preference but hey.
conf_intervalL <- predict(modelFTL, newdata=data.frame(tbL = newxL), interval="prediction",    level = 0.95)
plot(data_plot$fL ~ data_plot$tbL,
pch=19, col=colours); abline(modelFTL, col="black" )
lines(newxL, conf_intervalL [,2], col="blue", lty=2)
lines(newxL, conf_intervalL [,3], col="blue", lty=2)
#text((data_plot$fL ~ data_plot$tbL), label=data$species)
#fill in area between regression line and confidence interval - very pretty but then you have to re-plot the points
polygon(c(rev(newxL), newxL), c(rev(conf_intervalL [ ,3]), conf_intervalL[ ,2]), density = 25, col = 'grey', border = NA)
points(data_plot$fL ~ data_plot$tbL,
pch=19, col=colours); abline(modelFTL, col="black" )
lines(newxL, conf_intervalL [,2], col="blue", lty=2)
lines(newxL, conf_intervalL [,3], col="blue", lty=2)
#mean lengths of the femur, tibiotarsus, and tarsometatarsus
#Aepyornis hildebrandti is excluded as Hasnford and Turvery have no tibiotarsi measurements
mean_lengths <- read.csv (file = "../Data/Raw/mean_lengths_2.csv")
#making sure that the bone is a factor so that it stacks correctly in the plot
mean_lengths$bone <- factor(mean_lengths$bone, levels = c("Femur", "Tibiotarsus", "Tarsometatarsus"))
#this makes the species labels along the x axis run in this order
mean_lengths$species <- factor (mean_lengths$species, levels = c("Struthio camelus", "Casuarius casuarius",	"Dromaius novaehollandiae",	"Pachyornis elephantopus",	"Dinornis novaezealandiae",	"Dinornis robustus",	"Mullerornis modestus",	"Aepyornis maximus",	"Alectura lathami",	"Leipoa ocellata",	"Anseranas semipalmata",	"Cereopsis novaehollandiae",	"Dinornis stirtoni", "Illbandornis woodburnei",	"Illbandornis lawsoni",	"Genyornis newtoni"))
#code for the bar plot
ggplot(mean_lengths, aes(fill = bone, y = mean_length, x = species)) +
geom_bar(position="fill", stat="identity") +
#labels for the x, y axis, plot title, and legend
labs(title = "Mean Lengths of Bones by Species",
x = "Species",
y = "Total pecentage of hindlimb legnth ",
fill = "Hindlimb bone") +
#colours for the hindlimb bones and order that they should plot as
scale_fill_manual(values = c("Femur" = "#e31a1c", "Tibiotarsus" = "#1f78b4", "Tarsometatarsus" = "#33a02c")) +
#y axis should be in 10% increments instead of the standaard 25%
scale_y_continuous(breaks = seq(0, 1, by = 0.1),
labels = function(x) paste0(x * 100, "%")) +
#tilts the x axis labels vertical
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
#a ggplot is the base function
#often will be followed by a '+' sign
#here i am plotting the ratio of the tarsometatarsus length and medial-lateral width against the medial lateral width
#running this on my complete dataset of just tarsometatarsus measurements
tmt_data <- read.csv (file = "../Data/Raw/tmt_data.csv")
#this makes the species labels along the x axis run in this order
tmt_data$species <- factor (tmt_data$species, levels = c("Struthio camelus", "Casuarius casuarius",	"Dromaius novaehollandiae",	"Pachyornis elephantopus",	"Dinornis novaezealandiae",	"Dinornis robustus",	"Mullerornis modestus",	"Aepyornis hildebrandti", "Aepyornis maximus",	"Alectura lathami",	"Leipoa ocellata",	"Anseranas semipalmata",	"Cereopsis novaehollandiae",	"Dromornis stirtoni", "Illbandornis woodburnei",	"Illbandornis lawsoni",	"Genyornis newtoni"))
#code for plotting
ggplot(
data = tmt_data,
mapping = aes(x = tmtL/tmtM.L, y = tmtM.L, color = species)
) +
geom_point() +
geom_vline(xintercept = 12) +
labs(
x = "Tarsometatarsus length/medial-lateral width (mm)", y = "Tarsometatarsus medial-lateral width (mm)",
color = "Species", shape = "Species"
)
#here is the link that I was using https://r4ds.hadley.nz/data-visualize
#geom_point removes rows containing missing values or values outside the scale range
#might see what it looks like log() transformed, but currently (26/06/2024) am happy not to
#creating a sub dataset for just the flightless birds
#make a data set with extant ratites
ratite_tmt <- tmt_data[c(5:25),]
#make a data set with extinct large birds (ratites + dromorntithids)
extinct_tmt <- tmt_data[c(77:183),]
#combine the 2 datasets
largebirds_tmt <- rbind(ratite_tmt, extinct_tmt)
#this makes the species labels along the x axis run in this order
largebirds_tmt$species <- factor (largebirds_tmt$species, levels = c("Struthio camelus", "Casuarius casuarius",	"Dromaius novaehollandiae",	"Pachyornis elephantopus",	"Dinornis novaezealandiae",	"Dinornis robustus",	"Mullerornis modestus",	"Aepyornis hildebrandti", "Aepyornis maximus",	"Dromornis stirtoni", "Illbandornis woodburnei",	"Illbandornis lawsoni",	"Genyornis newtoni"))
#a ggplot is the base function
#often will be followed by a '+' sign
#here i am plotting the ratio of the tarsometatarsus length and medial-lateral width against the medial lateral wdith
#running this on just that dataset containing large flightless birds
ggplot(
data = largebirds_tmt,
mapping = aes(x = tmtL/tmtM.L, y = tmtM.L, color = species)
) +
geom_point() +
geom_vline(xintercept = 12) +
labs(
x = "Tarsometatarsus length/medial-lateral width (mm)", y = "Tarsometatarsus medial-lateral width (mm)",
color = "Species", shape = "Species"
)
#if I add the colours to the species, the legend than assigns the species as hex values
#geom_point removes rows containing missing values or values outside the scale range
#data that includes Dinornithiformes, Dromornis stirtoni, & Illbandornis sp.
data2 <- read.csv (file = "../Data/Raw/honours_hindlimb_updated.csv")
#a ggplot is the base function
#often will be followed by a '+' sign
#here i am plotting the ratio of the tarsometatarsus length and medial-lateral width against the medial lateral width
#running this on my complete dataset of just tarsometatarsus measurements
tmt_data <- read.csv (file = "../Data/Raw/tmt_data.csv")
#this makes the species labels along the x axis run in this order
tmt_data$species <- factor (tmt_data$species, levels = c("Struthio camelus", "Casuarius casuarius",	"Dromaius novaehollandiae",	"Pachyornis elephantopus",	"Dinornis novaezealandiae",	"Dinornis robustus",	"Mullerornis modestus",	"Aepyornis hildebrandti", "Aepyornis maximus",	"Alectura lathami",	"Leipoa ocellata",	"Anseranas semipalmata",	"Cereopsis novaehollandiae",	"Dromornis stirtoni", "Illbandornis woodburnei",	"Illbandornis lawsoni",	"Genyornis newtoni"))
#code for plotting
ggplot(
data = tmt_data,
mapping = aes(x = tmtL/tmtM.L, y = tmtM.L, color = species)
) +
geom_point() +
geom_vline(xintercept = 12) +
labs(
x = "Tarsometatarsus length/medial-lateral width (mm)", y = "Tarsometatarsus medial-lateral width (mm)",
color = "Species", shape = "Species"
)
#here is the link that I was using https://r4ds.hadley.nz/data-visualize
#geom_point removes rows containing missing values or values outside the scale range
#might see what it looks like log() transformed, but currently (26/06/2024) am happy not to
#creating a sub dataset for just the flightless birds
#make a data set with extant ratites
ratite_tmt <- tmt_data[c(5:25),]
#make a data set with extinct large birds (ratites + dromorntithids)
extinct_tmt <- tmt_data[c(77:183),]
#combine the 2 datasets
largebirds_tmt <- rbind(ratite_tmt, extinct_tmt)
#this makes the species labels along the x axis run in this order
largebirds_tmt$species <- factor (largebirds_tmt$species, levels = c("Struthio camelus", "Casuarius casuarius",	"Dromaius novaehollandiae",	"Pachyornis elephantopus",	"Dinornis novaezealandiae",	"Dinornis robustus",	"Mullerornis modestus",	"Aepyornis hildebrandti", "Aepyornis maximus",	"Dromornis stirtoni", "Illbandornis woodburnei",	"Illbandornis lawsoni",	"Genyornis newtoni"))
#a ggplot is the base function
#often will be followed by a '+' sign
#here i am plotting the ratio of the tarsometatarsus length and medial-lateral width against the medial lateral wdith
#running this on just that dataset containing large flightless birds
ggplot(
data = largebirds_tmt,
mapping = aes(x = tmtL/tmtM.L, y = tmtM.L, color = species)
) +
geom_point() +
geom_vline(xintercept = 12) +
labs(
x = "Tarsometatarsus length/medial-lateral width (mm)", y = "Tarsometatarsus medial-lateral width (mm)",
color = "Species", shape = "Species"
)
#if I add the colours to the species, the legend than assigns the species as hex values
#geom_point removes rows containing missing values or values outside the scale range
#a ggplot is the base function
#often will be followed by a '+' sign
#here i am plotting the ratio of the tarsometatarsus length and medial-lateral width against the medial lateral width
#running this on my complete dataset of just tarsometatarsus measurements
tmt_data <- read.csv (file = "../Data/Raw/tmt_data.csv")
#this makes the species labels along the x axis run in this order
tmt_data$species <- factor (tmt_data$species, levels = c("Struthio camelus", "Casuarius casuarius",	"Dromaius novaehollandiae",	"Pachyornis elephantopus",	"Dinornis novaezealandiae",	"Dinornis robustus",	"Mullerornis modestus",	"Aepyornis hildebrandti", "Aepyornis maximus",	"Alectura lathami",	"Leipoa ocellata",	"Anseranas semipalmata",	"Cereopsis novaehollandiae",	"Dromornis stirtoni", "Illbandornis woodburnei",	"Illbandornis lawsoni",	"Genyornis newtoni"))
#code for plotting
ggplot(
data = tmt_data,
mapping = aes(x = tmtL/tmtM.L, y = tmtM.L, color = species)
) +
geom_point() +
geom_vline(xintercept = 12) +
labs(
x = "Tarsometatarsus length/medial-lateral width (mm)", y = "Tarsometatarsus medial-lateral width (mm)",
color = "Species", shape = "Species"
)
#here is the link that I was using https://r4ds.hadley.nz/data-visualize
#geom_point removes rows containing missing values or values outside the scale range
#might see what it looks like log() transformed, but currently (26/06/2024) am happy not to
#creating a sub dataset for just the flightless birds
#make a data set with extant ratites
ratite_tmt <- tmt_data[c(5:25),]
#make a data set with extinct large birds (ratites + dromorntithids)
extinct_tmt <- tmt_data[c(77:183),]
#combine the 2 datasets
largebirds_tmt <- rbind(ratite_tmt, extinct_tmt)
#this makes the species labels along the x axis run in this order
largebirds_tmt$species <- factor (largebirds_tmt$species, levels = c("Struthio camelus", "Casuarius casuarius",	"Dromaius novaehollandiae",	"Pachyornis elephantopus",	"Dinornis novaezealandiae",	"Dinornis robustus",	"Mullerornis modestus",	"Aepyornis hildebrandti", "Aepyornis maximus",	"Dromornis stirtoni", "Illbandornis woodburnei",	"Illbandornis lawsoni",	"Genyornis newtoni"))
#a ggplot is the base function
#often will be followed by a '+' sign
#here i am plotting the ratio of the tarsometatarsus length and medial-lateral width against the medial lateral wdith
#running this on just that dataset containing large flightless birds
ggplot(
data = largebirds_tmt,
mapping = aes(x = tmtL/tmtM.L, y = tmtM.L, color = species)
) +
geom_point() +
geom_vline(xintercept = 12) +
labs(
x = "Tarsometatarsus length/medial-lateral width (mm)", y = "Tarsometatarsus medial-lateral width (mm)",
color = "Species", shape = "Species"
)
#if I add the colours to the species, the legend than assigns the species as hex values
#geom_point removes rows containing missing values or values outside the scale range
symb <- rep(pch = 19, nrow(data_plot))
symb[which(data_plot$species == "Genyornis newtoni")] <- pch = 20
rm(symb)
longbone_length <- read.csv (file = "../Data/Raw/longbone_lengths.csv")
library("ggtern")
ggtern(data=longbone_length, aes (x = fL, y = tbL, z = tmtL)) +
geom_point()
save.image("~/Workspace/Genyornis_honours/Analyses/.RData")
